{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport React, { useState, useEffect } from 'react';\nimport { BarCodeScanner } from 'expo-barcode-scanner';\nimport Button from \"react-native-web/dist/exports/Button\";\nimport { auth, db } from \"../Config/Firebase\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { addDoc, collection, getDocs, query, where } from 'firebase/firestore';\nimport moment from 'moment';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar ClockOut = function ClockOut(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    hasPermission = _useState2[0],\n    setHasPermission = _useState2[1];\n  var _useState3 = useState(),\n    _useState4 = _slicedToArray(_useState3, 2),\n    scanData = _useState4[0],\n    setScanData = _useState4[1];\n  var _useState5 = useState({}),\n    _useState6 = _slicedToArray(_useState5, 2),\n    userInfo = _useState6[0],\n    setInfo = _useState6[1];\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var _yield$BarCodeScanner = yield BarCodeScanner.requestPermissionsAsync(),\n        status = _yield$BarCodeScanner.status;\n      setHasPermission(status === 'granted');\n    });\n\n    var user = auth.currentUser;\n    var getUserData = function () {\n      var _ref3 = _asyncToGenerator(function* () {\n        var userRef = collection(db, 'users');\n        var q = query(collection(db, 'users'), where('userId', '==', user.uid));\n        var data = yield getDocs(q);\n        data.forEach(function (results) {\n          console.log(results.data());\n          setInfo(results.data());\n        });\n      });\n      return function getUserData() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    getUserData();\n  }, []);\n\n  function ClockOut() {\n    var userRef = collection(db, 'clockout');\n    var clockoutTime = moment().format('LT');\n    var attendanceDetails = {\n      name: scanData.name,\n      surname: scanData.surname,\n      email: scanData.email,\n      userId: scanData.userId,\n      date: moment().format('LL'),\n      time: moment().format('LT')\n    };\n    addDoc(userRef, attendanceDetails).then(function () {\n      console.log('data added');\n    }).catch(function (error) {\n      console.log(error.message);\n    });\n  }\n  if (hasPermission) {\n    return _jsx(_Fragment, {\n      children: _jsx(View, {\n        style: styles.container,\n        children: _jsx(Text, {\n          children: \"Please grand camera permission!\"\n        })\n      })\n    });\n  }\n  var handleBarCodeScanner = function handleBarCodeScanner(_ref4) {\n    var type = _ref4.type,\n      data = _ref4.data;\n    var date = new Date().toLocaleString();\n    var details = {\n      name: 'Moraswi',\n      surname: 'Tahbiso',\n      timeIn: date\n    };\n    setScanData(data = userInfo);\n    console.log('data', data);\n    console.log('data', type);\n  };\n  return _jsx(_Fragment, {\n    children: _jsxs(View, {\n      style: styles.container,\n      children: [_jsx(BarCodeScanner, {\n        style: StyleSheet.absoluteFillObject,\n        onBarCodeScanned: scanData ? undefined : handleBarCodeScanner\n      }), scanData && navigation.navigate('Home'), scanData && Alert.alert(\"Good bye\", \" \\\"You have successfully clocked out \\n\\n  Time: \" + moment().format('LT') + \"\\\" \", [{\n        text: \"OK\"\n      }]), scanData && ClockOut()]\n    })\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});\nexport default ClockOut;","map":{"version":3,"names":["React","useState","useEffect","BarCodeScanner","auth","db","onAuthStateChanged","addDoc","collection","getDocs","query","where","moment","ClockOut","navigation","hasPermission","setHasPermission","scanData","setScanData","userInfo","setInfo","requestPermissionsAsync","status","user","currentUser","getUserData","userRef","q","uid","data","forEach","results","console","log","clockoutTime","format","attendanceDetails","name","surname","email","userId","date","time","then","catch","error","message","styles","container","handleBarCodeScanner","type","Date","toLocaleString","details","timeIn","StyleSheet","absoluteFillObject","undefined","navigate","Alert","alert","text","create","flex","backgroundColor","alignItems","justifyContent"],"sources":["/Users/mlab/Documents/Clockify/components/ClockOut.js"],"sourcesContent":["import { View, Text ,StyleSheet,Alert } from 'react-native'\r\nimport React,{useState,useEffect} from 'react'\r\nimport { BarCodeScanner } from 'expo-barcode-scanner'\r\nimport { Button } from 'react-native'\r\n\r\nimport { auth, db } from '../Config/Firebase';\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { addDoc, collection, getDocs, query, where } from 'firebase/firestore';\r\n\r\nimport moment from 'moment'\r\n\r\n\r\nconst ClockOut = ({navigation}) => {\r\n    const [hasPermission, setHasPermission] = useState(false)\r\n    const [scanData, setScanData] = useState()\r\n    const [userInfo, setInfo] = useState({})\r\n\r\n    useEffect(()=>{\r\n      (async()=>{\r\n          const {status} = await BarCodeScanner.requestPermissionsAsync();\r\n          setHasPermission(status==='granted')\r\n      })\r\n\r\n           //getting current logged user\r\n           const user = auth.currentUser;\r\n\r\n           const getUserData = async() =>{\r\n             const userRef = collection(db,'users')\r\n             const q = query(collection(db,'users'), where('userId', '==', user.uid))\r\n             const data = await getDocs(q);\r\n             data.forEach((results)=>{\r\n               console.log(results.data())\r\n               setInfo(results.data())\r\n             })        \r\n     \r\n     \r\n           }\r\n           getUserData()\r\n    },[])\r\n\r\n     //adding attendance data to firebase\r\n     function ClockOut(){\r\n      const userRef = collection(db, 'clockout')\r\n      var clockoutTime = moment().format('LT');\r\n\r\n      const attendanceDetails = {\r\n            name:scanData.name,\r\n            surname:scanData.surname,\r\n            email:scanData.email,\r\n            userId:scanData.userId,\r\n            date:moment().format('LL'),\r\n            time:moment().format('LT'),\r\n\r\n      }\r\n\r\n      addDoc(userRef,attendanceDetails).then(()=>{\r\n        console.log('data added')\r\n       }).catch((error)=>{\r\n          console.log(error.message)\r\n       })\r\n  \r\n    }\r\n\r\n    if(hasPermission){\r\n        return(\r\n            <>\r\n                <View style={styles.container}>\r\n                  <Text>Please grand camera permission!</Text>\r\n               </View>\r\n            </>\r\n        )\r\n    }\r\n\r\n    const handleBarCodeScanner = ({type,data}) =>{\r\n        const date = new Date().toLocaleString();\r\n        const details = {\r\n            name:'Moraswi',\r\n            surname:'Tahbiso',\r\n            timeIn:date\r\n        }\r\n       \r\n        setScanData(data=userInfo);\r\n       \r\n        console.log('data', data)\r\n        console.log('data', type)\r\n    }\r\n  return (\r\n    <>\r\n    <View style={styles.container}>\r\n     <BarCodeScanner\r\n      style={StyleSheet.absoluteFillObject}\r\n      onBarCodeScanned = {scanData? undefined : handleBarCodeScanner}\r\n     />\r\n      {scanData && navigation.navigate('Home') }\r\n\r\n{\r\n    scanData&&  Alert.alert(\r\n     \"Good bye\",\r\n     ` \"You have successfully clocked out \\n\\n  Time: ${moment().format('LT')}\" `,\r\n     [\r\n     \r\n       { text: \"OK\" }\r\n     ]\r\n   )\r\n}\r\n{\r\n scanData && ClockOut()\r\n}\r\n\r\n     \r\n   </View>\r\n</>\r\n\r\n  )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n      flex: 1,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center', \r\n      justifyContent: 'center',\r\n    },\r\n  });\r\n  \r\n\r\n\r\n\r\n\r\n\r\nexport default ClockOut"],"mappings":"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"},"metadata":{},"sourceType":"module"}